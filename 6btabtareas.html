<!-- MOD-001: ENCABEZADO [INICIO] -->
<!--
*****************************************
PROYECTO: PBE Control
ARCHIVO: 6btabtareas.html
VERSI√ìN: 01.19
FECHA: 18/01/2026 15:53 (UTC-5)
*****************************************
-->
<!-- MOD-001: FIN -->

<!-- MOD-002: ESTILOS [INICIO] -->
<style>
/* CONTENEDOR PRINCIPAL */
.tareas-container {
  background: white;
  border-radius: 12px;
  padding: 24px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
}

.tareas-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
  flex-wrap: wrap;
  gap: 16px;
}

.tareas-header h2 {
  color: #333;
  font-size: 20px;
  margin: 0;
}

.header-actions {
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
}

/* FILTROS */
.filtro-container {
  display: flex;
  align-items: center;
  gap: 8px;
}

.filtro-container label {
  font-size: 13px;
  font-weight: 600;
  color: #666;
}

.filtro-container select {
  padding: 8px 12px;
  border: 2px solid #ddd;
  border-radius: 6px;
  font-size: 13px;
  min-width: 150px;
  cursor: pointer;
  transition: border-color 0.3s;
}

.filtro-container select:focus {
  outline: none;
  border-color: #667eea;
}

/* BOTONES */
.btn-agregar {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 10px 20px;
  border: none;
  border-radius: 8px;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
  box-shadow: 0 2px 6px rgba(102, 126, 234, 0.3);
}

.btn-agregar:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
}

.btn {
  padding: 10px 20px;
  border: none;
  border-radius: 6px;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
  font-family: inherit;
}

.btn-primary {
  background: #667eea;
  color: white;
}

.btn-primary:hover {
  background: #5568d3;
}

.btn-secondary {
  background: #6c757d;
  color: white;
}

.btn-secondary:hover {
  background: #5a6268;
}

.btn-icon {
  background: transparent;
  border: none;
  color: #667eea;
  cursor: pointer;
  font-size: 18px;
  padding: 4px 8px;
  transition: all 0.2s;
}

.btn-icon:hover {
  transform: scale(1.2);
}

.btn-icon.delete {
  color: #dc3545;
}

/* FORMULARIO */
.form-tarea {
  background: #f9f9f9;
  border: 2px solid #e0e0e0;
  border-radius: 10px;
  padding: 20px;
  margin-bottom: 24px;
  display: none;
}

.form-tarea.active {
  display: block;
  animation: slideDown 0.3s ease-out;
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.form-row {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 16px;
  margin-bottom: 16px;
}

.form-group {
  margin-bottom: 0;
}

.form-group label {
  display: block;
  font-size: 13px;
  font-weight: 600;
  color: #333;
  margin-bottom: 6px;
}

.form-group label .required {
  color: #dc3545;
}

.form-group input,
.form-group select {
  width: 100%;
  padding: 10px 12px;
  font-size: 14px;
  border: 2px solid #ddd;
  border-radius: 6px;
  transition: all 0.3s;
  font-family: inherit;
}

.form-group input:focus,
.form-group select:focus {
  outline: none;
  border-color: #667eea;
  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.form-group small {
  display: block;
  margin-top: 4px;
  font-size: 12px;
  color: #666;
}

.form-actions {
  display: flex;
  gap: 12px;
  margin-top: 16px;
}

/* TABLA DE TAREAS */
.tareas-table-container {
  overflow-x: auto;
}

.tareas-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 14px;
}

.tareas-table thead {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
}

.tareas-table th {
  padding: 12px;
  text-align: left;
  font-weight: 600;
  font-size: 13px;
}

.tareas-table tbody tr {
  border-bottom: 1px solid #e0e0e0;
  transition: background 0.2s;
}

.tareas-table tbody tr:hover {
  background: #f8f9fa;
}

.tareas-table td {
  padding: 12px;
  color: #333;
}

/* CURSO TAG */
.curso-tag {
  display: inline-block;
  padding: 4px 10px;
  border-radius: 6px;
  font-size: 13px;
  font-weight: 600;
  background: #e9ecef;
  color: #495057;
}

/* COLORES DIN√ÅMICOS EN NOTA */
.nota-cell {
  text-align: center;
  font-weight: 600;
  font-size: 15px;
}

.nota-alta {
  color: #28a745;
}

.nota-media {
  color: #ffc107;
}

.nota-baja {
  color: #dc3545;
}

.nota-pendiente {
  color: #999;
  font-style: italic;
}

/* FECHA, PESO Y SEMANA */
.fecha-cell {
  white-space: nowrap;
}

.peso-cell {
  text-align: center;
  color: #666;
}

.sem-cell {
  text-align: center;
  color: #666;
  font-size: 13px;
}

/* ESTADO VAC√çO */
.empty-state {
  text-align: center;
  padding: 60px 20px;
  color: #999;
}

.empty-state-icon {
  font-size: 48px;
  margin-bottom: 12px;
  opacity: 0.5;
}

.empty-state-text {
  font-size: 15px;
}

/* LOADING */
.loading-container {
  text-align: center;
  padding: 40px;
  color: #667eea;
}

.spinner {
  display: inline-block;
  width: 40px;
  height: 40px;
  border: 4px solid rgba(102, 126, 234, 0.2);
  border-top-color: #667eea;
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

/* RESPONSIVE */
@media (max-width: 768px) {
  .tareas-container {
    padding: 16px;
  }

  .tareas-header {
    flex-direction: column;
    align-items: flex-start;
  }

  .header-actions {
    width: 100%;
  }

  .btn-agregar,
  .filtro-container {
    width: 100%;
  }

  .filtro-container {
    flex-direction: column;
    align-items: flex-start;
  }

  .filtro-container select {
    width: 100%;
  }

  .form-row {
    grid-template-columns: 1fr;
  }

  .form-actions {
    flex-direction: column;
  }

  .form-actions .btn {
    width: 100%;
  }

  .tareas-table {
    font-size: 13px;
  }

  .tareas-table th,
  .tareas-table td {
    padding: 8px;
  }

  .tareas-table .col-sem {
    display: none;
  }
}
</style>
<!-- MOD-002: FIN -->

<!-- MOD-003: CONTENEDOR PRINCIPAL [INICIO] -->
<div class="tareas-container">

  <div class="tareas-header">
    <h2>‚úèÔ∏è Mis Tareas</h2>
    <div class="header-actions">
      <div class="filtro-container">
        <label>Filtrar:</label>
        <select id="filtroCurso" onchange="aplicarFiltro()">
          <option value="">Todos los cursos</option>
        </select>
      </div>
      <button class="btn-agregar" onclick="toggleFormAgregar()">
        + Agregar Tarea
      </button>
    </div>
  </div>

  <div id="formTarea" class="form-tarea">
    <h3 id="formTitle" style="margin-bottom: 16px; color: #667eea;">Agregar Nueva Tarea</h3>

    <form id="tareaForm" onsubmit="handleSubmitTarea(event)">
      <input type="hidden" id="tareaRowNumber" value="">
      <input type="hidden" id="tareaModoEdicion" value="false">

      <div class="form-row">
        <div class="form-group">
          <label>Curso <span class="required">*</span></label>
          <select id="tareaCurso" required>
            <option value="">Seleccionar curso...</option>
          </select>
        </div>

        <div class="form-group">
          <label>Nombre de la Tarea <span class="required">*</span></label>
          <input
            type="text"
            id="tareaTarea"
            placeholder="Ej: Trabajo de Investigaci√≥n"
            required
          >
          <small>Nombre √∫nico por curso</small>
        </div>

        <div class="form-group">
          <label>Fecha de Entrega <span class="required">*</span></label>
          <input
            type="text"
            id="tareaFechaEntrega"
            placeholder="DD/MM/AAAA"
            required
          >
          <small>Fecha l√≠mite de entrega</small>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>Fecha de Realizaci√≥n (Opcional)</label>
          <input
            type="text"
            id="tareaFechaAccion"
            placeholder="DD/MM/AAAA"
          >
          <small>Fecha en que se complet√≥</small>
        </div>

        <div class="form-group">
          <label>Nota (Opcional)</label>
          <input
            type="number"
            id="tareaNota"
            placeholder="0 - 20"
            min="0"
            max="20"
            step="0.1"
          >
          <small>Calificaci√≥n (0-20)</small>
        </div>

        <div class="form-group">
          <label>Peso (Opcional)</label>
          <input
            type="number"
            id="tareaPeso"
            placeholder="%"
            min="0"
            max="100"
            step="1"
          >
          <small>Peso % (ej: 25)</small>
        </div>

        <div class="form-group">
          <label>Semana (Opcional)</label>
          <input
            type="number"
            id="tareaSem"
            placeholder="N¬∫ semana"
            min="1"
            step="1"
          >
          <small>Semana acad√©mica</small>
        </div>
      </div>

      <div class="form-actions">
        <button type="submit" class="btn btn-primary" id="btnSubmit">
          Guardar Tarea
        </button>
        <button type="button" class="btn btn-secondary" onclick="cancelarFormTarea()">
          Cancelar
        </button>
      </div>
    </form>
  </div>

  <div id="tareasTableContainer" class="tareas-table-container">
    <div class="loading-container">
      <div class="spinner"></div>
      <p>Cargando tareas...</p>
    </div>
  </div>

</div>
<!-- MOD-003: FIN -->

<!-- MOD-004: JAVASCRIPT [INICIO] -->
<script>
(function PBE_TAREAS_MODULE() {
  'use strict';

  // VARIABLES LOCALES (ENCAPSULADAS)
  let tareasData = [];
  let cursosData = [];
  let tareasFiltradas = [];
  let _initDone = false;

  // INICIALIZACI√ìN (IDEMPOTENTE)
  function init() {
    if (_initDone) return;

    if (typeof currentUser === 'undefined' || !currentUser.codeAlum) {
      showAlert('error', 'Error: No se pudo identificar al usuario');
      return;
    }

    _initDone = true;
    cargarCursos();
    cargarTareas();
  }

  window.addEventListener('load', init);

  if (typeof currentUser !== 'undefined' && currentUser && currentUser.codeAlum) {
    init();
  }

  // CARGAR CURSOS (para dropdown)
  function cargarCursos() {
    google.script.run
      .withSuccessHandler(handleCursosLoaded)
      .withFailureHandler(handleError)
      .studentObtenerCursos({ codeAlum: currentUser.codeAlum });
  }

  function handleCursosLoaded(response) {
    if (!response || response.success !== true) {
      const msg = response && response.error ? response.error : 'No se pudieron cargar los cursos.';
      showAlert('error', 'Error al cargar cursos: ' + msg);
      return;
    }

    cursosData = response.data || [];
    poblarDropdownCursos();
  }

  function poblarDropdownCursos() {
    const selectCurso = document.getElementById('tareaCurso');
    const selectFiltro = document.getElementById('filtroCurso');

    selectCurso.innerHTML = '<option value="">Seleccionar curso...</option>';
    selectFiltro.innerHTML = '<option value="">Todos los cursos</option>';

    cursosData.forEach(function(curso) {
      const label = (curso.Curso || '') + ' - ' + (curso.Completo || '');

      const option1 = document.createElement('option');
      option1.value = curso.Curso;
      option1.textContent = label;
      selectCurso.appendChild(option1);

      const option2 = document.createElement('option');
      option2.value = curso.Curso;
      option2.textContent = label;
      selectFiltro.appendChild(option2);
    });
  }

  // CARGAR TAREAS
  function cargarTareas() {
    google.script.run
      .withSuccessHandler(handleTareasLoaded)
      .withFailureHandler(handleTareasError)
      .studentObtenerTareas({ codeAlum: currentUser.codeAlum });
  }

  function handleTareasLoaded(response) {
    if (!response || response.success !== true) {
      const msg = response && response.error ? response.error : 'No se pudieron cargar las tareas.';
      showAlert('error', 'Error al cargar tareas: ' + msg);
      renderEmptyState();
      return;
    }

    tareasData = response.data || [];
    tareasFiltradas = tareasData;

    if (typeof updateDeberesBadge === 'function') {
      updateDeberesBadge('tareas', tareasData.length);
    }

    renderTareasTable();
  }

  function handleTareasError(error) {
    console.error('Error al cargar tareas:', error);
    showAlert('error', 'Error de conexi√≥n al cargar tareas');
    renderEmptyState();
  }

  // APLICAR FILTRO
  function aplicarFiltro() {
    const cursoSeleccionado = document.getElementById('filtroCurso').value;

    if (cursoSeleccionado === '') {
      tareasFiltradas = tareasData;
    } else {
      tareasFiltradas = tareasData.filter(function(t) {
        return t.Curso === cursoSeleccionado;
      });
    }

    renderTareasTable();
  }

  // RENDERIZAR TABLA
  function renderTareasTable() {
    const container = document.getElementById('tareasTableContainer');

    if (!tareasFiltradas || tareasFiltradas.length === 0) {
      renderEmptyState();
      return;
    }

    let html = '<table class="tareas-table"><thead><tr><th>Curso</th><th>Tarea</th><th>Entrega</th><th>Acci√≥n</th><th>Nota</th><th>Peso</th><th class="col-sem">Semana</th><th>Acciones</th></tr></thead><tbody>';

    tareasFiltradas.forEach(function(t) {
      const claseNota = obtenerClaseNota(t.Nota);
      const tareaSafe = String(t.Tarea || '').replace(/'/g, "\\'");

      html += '<tr>';
      html += '<td><span class="curso-tag">' + t.Curso + '</span></td>';
      html += '<td><strong>' + t.Tarea + '</strong></td>';
      html += '<td class="fecha-cell">' + t.FechaEntrega + '</td>';
      html += '<td class="fecha-cell">' + (t.FechaAccion || '-') + '</td>';
      html += '<td class="nota-cell ' + claseNota + '">';
      html += t.Nota ? t.Nota : '<span class="nota-pendiente">Pendiente</span>';
      html += '</td>';
      html += '<td class="peso-cell">' + (t.Peso ? t.Peso + '%' : '-') + '</td>';
      html += '<td class="sem-cell col-sem">' + (t.Sem || '-') + '</td>';
      html += '<td>';
      html += '<button class="btn-icon" onclick="editarTarea(' + t._rowNumber + ')" title="Editar">‚úèÔ∏è</button>';
      html += '<button class="btn-icon delete" onclick="confirmarEliminarTarea(' + t._rowNumber + ', \'' + tareaSafe + '\')" title="Eliminar">üóëÔ∏è</button>';
      html += '</td>';
      html += '</tr>';
    });

    html += '</tbody></table>';
    container.innerHTML = html;
  }

  function renderEmptyState() {
    const container = document.getElementById('tareasTableContainer');
    const filtroActivo = document.getElementById('filtroCurso').value !== '';

    if (filtroActivo) {
      container.innerHTML = '<div class="empty-state"><div class="empty-state-icon">üîç</div><div class="empty-state-text">No hay tareas para el curso seleccionado.</div></div>';
    } else {
      container.innerHTML = '<div class="empty-state"><div class="empty-state-icon">‚úèÔ∏è</div><div class="empty-state-text">No tienes tareas registradas a√∫n.<br>Haz clic en "+ Agregar Tarea" para comenzar.</div></div>';
    }
  }

  // TOGGLE FORMULARIO
  function toggleFormAgregar() {
    const form = document.getElementById('formTarea');
    const isActive = form.classList.contains('active');

    if (isActive) {
      form.classList.remove('active');
    } else {
      resetFormTarea();
      document.getElementById('formTitle').textContent = 'Agregar Nueva Tarea';
      document.getElementById('tareaModoEdicion').value = 'false';
      form.classList.add('active');
    }
  }

  // SUBMIT FORMULARIO
  function handleSubmitTarea(event) {
    event.preventDefault();

    const curso = document.getElementById('tareaCurso').value;
    const tarea = document.getElementById('tareaTarea').value.trim();
    const fechaEntrega = document.getElementById('tareaFechaEntrega').value.trim();
    const fechaAccion = document.getElementById('tareaFechaAccion').value.trim();
    const nota = document.getElementById('tareaNota').value.trim();
    const peso = document.getElementById('tareaPeso').value.trim();
    const sem = document.getElementById('tareaSem').value.trim();
    const rowNumber = document.getElementById('tareaRowNumber').value;
    const esEdicion = document.getElementById('tareaModoEdicion').value === 'true';

    if (!curso || !tarea || !fechaEntrega) {
      showAlert('error', 'Completa todos los campos obligatorios');
      return;
    }

    if (!validarFecha(fechaEntrega)) {
      showAlert('error', 'Formato de fecha de entrega inv√°lido. Use DD/MM/AAAA');
      return;
    }

    if (fechaAccion && !validarFecha(fechaAccion)) {
      showAlert('error', 'Formato de fecha de realizaci√≥n inv√°lido. Use DD/MM/AAAA');
      return;
    }

    if (nota && (parseFloat(nota) < 0 || parseFloat(nota) > 20)) {
      showAlert('error', 'La nota debe estar entre 0 y 20');
      return;
    }

    if (peso && (parseFloat(peso) < 0 || parseFloat(peso) > 100)) {
      showAlert('error', 'El peso debe estar entre 0 y 100%');
      return;
    }

    const btnSubmit = document.getElementById('btnSubmit');
    btnSubmit.disabled = true;
    btnSubmit.textContent = esEdicion ? 'Actualizando...' : 'Guardando...';

    const params = {
      codeAlum: currentUser.codeAlum,
      curso: curso,
      tarea: tarea,
      fechaEntrega: fechaEntrega,
      fechaAccion: fechaAccion,
      nota: nota,
      peso: peso,
      sem: sem
    };

    if (esEdicion) {
      params.rowNumber = parseInt(rowNumber, 10);

      google.script.run
        .withSuccessHandler(handleTareaUpdated)
        .withFailureHandler(handleTareaError)
        .studentActualizarTarea(params);
    } else {
      google.script.run
        .withSuccessHandler(handleTareaAdded)
        .withFailureHandler(handleTareaError)
        .studentAgregarTarea(params);
    }
  }

  function handleTareaAdded(response) {
    const btnSubmit = document.getElementById('btnSubmit');
    btnSubmit.disabled = false;
    btnSubmit.textContent = 'Guardar Tarea';

    if (!response || response.success !== true) {
      const msg = response && response.error ? response.error : 'No se pudo agregar la tarea.';
      showAlert('error', msg);
      return;
    }

    showAlert('success', '‚úì Tarea agregada exitosamente');
    cancelarFormTarea();
    cargarTareas();
  }

  function handleTareaUpdated(response) {
    const btnSubmit = document.getElementById('btnSubmit');
    btnSubmit.disabled = false;
    btnSubmit.textContent = 'Guardar Tarea';

    if (!response || response.success !== true) {
      const msg = response && response.error ? response.error : 'No se pudo actualizar la tarea.';
      showAlert('error', msg);
      return;
    }

    showAlert('success', '‚úì Tarea actualizada exitosamente');
    cancelarFormTarea();
    cargarTareas();
  }

  function handleTareaError(error) {
    console.error('Error:', error);
    showAlert('error', 'Error de conexi√≥n. Intenta nuevamente');

    const btnSubmit = document.getElementById('btnSubmit');
    btnSubmit.disabled = false;
    btnSubmit.textContent = 'Guardar Tarea';
  }

  // EDITAR TAREA
  function editarTarea(rowNumber) {
    const t = tareasData.find(x => x._rowNumber === rowNumber);
    if (!t) return;

    document.getElementById('formTitle').textContent = 'Editar Tarea';
    document.getElementById('tareaRowNumber').value = rowNumber;
    document.getElementById('tareaModoEdicion').value = 'true';
    document.getElementById('tareaCurso').value = t.Curso;
    document.getElementById('tareaTarea').value = t.Tarea;
    document.getElementById('tareaFechaEntrega').value = t.FechaEntrega;
    document.getElementById('tareaFechaAccion').value = t.FechaAccion || '';
    document.getElementById('tareaNota').value = t.Nota || '';
    document.getElementById('tareaPeso').value = t.Peso || '';
    document.getElementById('tareaSem').value = t.Sem || '';

    document.getElementById('formTarea').classList.add('active');
    document.getElementById('tareaTarea').focus();
  }

  // ELIMINAR TAREA
  function confirmarEliminarTarea(rowNumber, nombreTarea) {
    if (confirm('¬øEliminar la tarea "' + nombreTarea + '"?\n\nEsta acci√≥n no se puede deshacer.')) {
      eliminarTarea(rowNumber);
    }
  }

  function eliminarTarea(rowNumber) {
    google.script.run
      .withSuccessHandler(handleTareaDeleted)
      .withFailureHandler(handleTareaError)
      .studentEliminarTarea({ rowNumber: rowNumber });
  }

  function handleTareaDeleted(response) {
    if (!response || response.success !== true) {
      const msg = response && response.error ? response.error : 'No se pudo eliminar la tarea.';
      showAlert('error', msg);
      return;
    }

    showAlert('success', '‚úì Tarea eliminada exitosamente');
    cargarTareas();
  }

  // RESET Y CANCELAR FORMULARIO
  function resetFormTarea() {
    document.getElementById('tareaForm').reset();
    document.getElementById('tareaRowNumber').value = '';
    document.getElementById('tareaModoEdicion').value = 'false';
  }

  function cancelarFormTarea() {
    document.getElementById('formTarea').classList.remove('active');
    resetFormTarea();
  }

  // FUNCI√ìN AUXILIAR: CLASE DE NOTA
  function obtenerClaseNota(nota) {
    if (!nota) return 'nota-pendiente';

    const notaNum = parseFloat(nota);

    if (notaNum >= 14) return 'nota-alta';
    if (notaNum >= 11) return 'nota-media';
    return 'nota-baja';
  }

  // UTILIDADES
  function handleError(error) {
    console.error('Error:', error);
    showAlert('error', 'Error de conexi√≥n');
  }

  console.log('%c‚úèÔ∏è Sub-tab Tareas V01.19 cargado', 'font-size: 11px; color: #667eea;');

  // EXPORTS A WINDOW (solo lo necesario)
  window.aplicarFiltro = aplicarFiltro;
  window.toggleFormAgregar = toggleFormAgregar;
  window.handleSubmitTarea = handleSubmitTarea;
  window.editarTarea = editarTarea;
  window.confirmarEliminarTarea = confirmarEliminarTarea;
  window.cancelarFormTarea = cancelarFormTarea;

  window.TareasModule = {
    init: init
  };
})();
</script>
<!-- MOD-004: FIN -->

<!-- MOD-099: NOTAS [INICIO] -->
<!--
DESCRIPCI√ìN:
Sub-tab de Tareas con CRUD completo
Lista de tareas con opciones para agregar, editar y eliminar

FUNCIONALIDAD:
Cargar tareas del estudiante al iniciar
Agregar nueva tarea con validaci√≥n
Editar tarea existente
Eliminar tarea con confirmaci√≥n
Filtrar por curso mediante dropdown
Validaci√≥n de campos obligatorios y rangos

CAMPOS DEL FORMULARIO:
Curso (select) - obligatorio
Nombre de Tarea - obligatorio
Fecha de Entrega (DD/MM/AAAA) - obligatorio
Fecha de Realizaci√≥n (DD/MM/AAAA) - opcional
Nota (0-20) - opcional
Peso (0-100%) - opcional
Semana (n√∫mero) - opcional

CARACTER√çSTICAS T√âCNICAS:
IIFE encapsulado para evitar colisi√≥n de variables globales
NULL-GUARD en todos los handlers de respuesta
Init idempotente compatible con lazy-load
Validaci√≥n de formato de fechas DD/MM/AAAA
Validaci√≥n de rangos num√©ricos
Escape de caracteres especiales en onclick

COLORES DIN√ÅMICOS:
Verde: Nota ‚â• 14
Amarillo: Nota 11-13
Rojo: Nota < 11
Gris: Pendiente (sin nota)

CONEXI√ìN BACKEND:
studentObtenerTareas({ codeAlum }): Lista de tareas
studentObtenerCursos({ codeAlum }): Para poblar dropdowns
studentAgregarTarea({ codeAlum, curso, tarea, fechaEntrega, fechaAccion, nota, peso, sem }): Crear
studentActualizarTarea({ ...params, rowNumber }): Actualizar
studentEliminarTarea({ rowNumber }): Eliminar

DEPENDENCIAS:
currentUser.codeAlum: Identificador del estudiante
showAlert(type, message): Funci√≥n global de alertas
validarFecha(fechaStr): Funci√≥n global de validaci√≥n de fechas
updateDeberesBadge(tab, count): Funci√≥n del contenedor padre (opcional)

TABLA:
Columnas: Curso, Tarea, Entrega, Acci√≥n, Nota, Peso, Semana, Acciones
Fecha Entrega: Fecha l√≠mite para completar
Fecha Acci√≥n: Fecha en que se realiz√≥/complet√≥
Botones: Editar (‚úèÔ∏è), Eliminar (üóëÔ∏è)
Responsive: Oculta columna Semana en m√≥vil

FORMULARIO:
Desplegable con animaci√≥n slideDown
Modo Agregar: Campos vac√≠os
Modo Editar: Campos prellenados
Validaci√≥n: HTML5 + JavaScript custom
Focus autom√°tico en campo Tarea al editar

ESTADOS UI:
Loading: Spinner mientras carga
Vac√≠o: Mensaje con instrucciones
Filtrado Vac√≠o: Mensaje espec√≠fico
Tabla: Grid con tareas y acciones

INTEGRACI√ìN:
Parent: 4btabdeberes.html (contenedor con lazy-load)
Backend: Wrappers student* en code.gs
M√≥dulo: Student.gs (l√≥gica de negocio)

PATCH V01.18.1:
Escape robusto para nombres de tarea en onclick
Maneja \, ', saltos de l√≠nea para evitar romper atributos HTML

CAMBIOS V01.18.1 ‚Üí V01.19:
Remodulaci√≥n Est√°ndar CodeWorkShop v4.0
CSS en MOD-002
HTML en MOD-003
JavaScript (IIFE) en MOD-004
Comentarios aligerados
Notas consolidadas en MOD-099
Mantiene l√≥gica funcional sin cambios
Mantiene escape de caracteres especiales
-->
<!-- MOD-099: FIN -->
