<!-- MOD-001: ENCABEZADO [INICIO] -->
<!--
*****************************************
PROYECTO: PBE Control
ARCHIVO: 4atabcursosyrep.html
VERSIÃ“N: 01.23
FECHA: 18/01/2026 12:35 (UTC-5)
*****************************************
-->
<!-- MOD-001: FIN -->

<!-- MOD-002: ESTILOS [INICIO] -->
<style>
.subtabs-container { margin-bottom: 20px; }

.subtabs-nav {
  display: flex;
  gap: 8px;
  border-bottom: 2px solid #e0e0e0;
  margin-bottom: 20px;
}

.subtab-btn {
  padding: 12px 24px;
  font-size: 14px;
  font-weight: 600;
  color: #666;
  background: transparent;
  border: none;
  border-bottom: 3px solid transparent;
  cursor: pointer;
  transition: all 0.3s;
}

.subtab-btn.active {
  color: #667eea;
  border-bottom-color: #667eea;
}

.subtab-content { display: none; }
.subtab-content.active { display: block; }
</style>
<!-- MOD-002: FIN -->

<!-- MOD-003: CONTENEDOR SUBTABS [INICIO] -->
<div class="subtabs-container">

  <div class="subtabs-nav">
    <button class="subtab-btn" id="btn-subtab-cursos"
      onclick="switchSubTab('cursos')">ðŸ“š Cursos</button>

    <button class="subtab-btn" id="btn-subtab-repasos"
      onclick="switchSubTab('repasos')">ðŸ”„ Repasos</button>
  </div>

  <div id="subtab-cursos" class="subtab-content" data-loaded="false">
    <?!= include('5atabcursos'); ?>
  </div>

  <div id="subtab-repasos" class="subtab-content" data-loaded="false">
    <?!= include('5atabrepasos'); ?>
  </div>

</div>
<!-- MOD-003: FIN -->

<!-- MOD-004: JAVASCRIPT [INICIO] -->
<script>
(function () {
  'use strict';

  const loaded = {
    cursos: false,
    repasos: false
  };

  // Switch de SubTabs
  function switchSubTab(name) {

    document.querySelectorAll('.subtab-content')
      .forEach(el => el.classList.remove('active'));

    document.querySelectorAll('.subtab-btn')
      .forEach(el => el.classList.remove('active'));

    document.getElementById('subtab-' + name).classList.add('active');
    document.getElementById('btn-subtab-' + name).classList.add('active');

    if (!loaded[name]) {
      loaded[name] = true;

      console.log('ðŸŸ¢ Inicializando subtab:', name);
      
      if (name === 'cursos' && window.CursosModule) {
        window.CursosModule.init();
      } else if (name === 'repasos' && window.RepasosModule) {
        window.RepasosModule.init();
      }

      document.dispatchEvent(
        new CustomEvent('pbe:subtab-activated', {
          detail: name
        })
      );
    }
  }

  // Auto-activar Cursos al cargar
  function initDefaultSubTab() {
    console.log('ðŸ“¦ 4atabcursosyrep V01.23: Activando Cursos por defecto');
    
    setTimeout(function() {
      switchSubTab('cursos');
    }, 100);
  }

  window.switchSubTab = switchSubTab;

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initDefaultSubTab);
  } else {
    initDefaultSubTab();
  }

  console.log('%cðŸ“¦ 4atabcursosyrep V01.23 cargado',
    'font-weight:bold;color:#667eea');
})();
</script>
<!-- MOD-004: FIN -->

<!-- MOD-099: NOTAS [INICIO] -->
<!--
DESCRIPCIÃ“N:
Contenedor de subtabs para Cursos y Repasos
Sistema de lazy-load controlado por eventos

SUBTABS INCLUIDOS:
- subtab-cursos â†’ include('5atabcursos')
- subtab-repasos â†’ include('5atabrepasos')

FUNCIONALIDAD:
- NavegaciÃ³n entre Cursos y Repasos mediante botones
- Lazy-load: Los subtabs solo se inicializan al activarse por primera vez
- Auto-activaciÃ³n: Cursos se activa por defecto al cargar

FLUJO DE INICIALIZACIÃ“N:
1. IIFE se ejecuta inmediatamente al cargar el mÃ³dulo
2. initDefaultSubTab() se llama con delay de 100ms
3. switchSubTab('cursos') activa el primer subtab
4. Llama a CursosModule.init() si existe
5. Dispara evento 'pbe:subtab-activated'

SISTEMA DE LAZY-LOAD:
- Variable loaded controla quÃ© subtabs ya fueron inicializados
- Primera activaciÃ³n: loaded[name] = false â†’ inicializa mÃ³dulo
- Activaciones posteriores: loaded[name] = true â†’ solo cambia UI

CONEXIÃ“N CON MÃ“DULOS:
- window.CursosModule.init(): Inicializa mÃ³dulo de cursos
- window.RepasosModule.init(): Inicializa mÃ³dulo de repasos
- Evento 'pbe:subtab-activated': Notifica activaciÃ³n de subtab

CARACTERÃSTICAS TÃ‰CNICAS:
- IIFE para encapsular lÃ³gica
- switchSubTab() expuesto globalmente
- Auto-inicializaciÃ³n inteligente (DOMContentLoaded o inmediato)
- Delay de 100ms para garantizar currentUser disponible

DEPENDENCIAS:
- window.CursosModule: Definido en 5atabcursos.html
- window.RepasosModule: Definido en 5atabrepasos.html
- currentUser: Variable global del panel principal

FIX CRÃTICO V01.22 â†’ V01.23:
- Activa subtab Cursos por defecto automÃ¡ticamente
- Conecta eventos con mÃ³dulos hijos correctamente
- Llama directamente a init() de mÃ³dulos
- Elimina race condition de inicializaciÃ³n

CAMBIOS V01.22 â†’ V01.23:
- RemodulaciÃ³n completa segÃºn EstÃ¡ndar CodeWorkShop v4.0
- CSS encapsulado en MOD-002
- HTML en MOD-003
- JavaScript en MOD-004 (IIFE completo)
- Comentarios consolidados en MOD-099
-->
<!-- MOD-099: FIN -->
