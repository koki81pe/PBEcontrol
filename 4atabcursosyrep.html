<!--
******************************************
PBE CONTROL - 4atabcursosyrep.html - V01.20 GPT
Sistema de GestiÃ³n AcadÃ©mica
07/01/2026

FIX CRÃTICO V01.20:
- Lazy-load REAL de subtabs
- Evita ejecuciÃ³n simultÃ¡nea de scripts hijos
- Solo se inicializa el subtab activo
- Emite evento controlado pbe:subtab-activated
******************************************
-->

<style>
  .subtabs-container { margin-bottom: 20px; }

  .subtabs-nav {
    display: flex;
    gap: 8px;
    border-bottom: 2px solid #e0e0e0;
    margin-bottom: 20px;
  }

  .subtab-btn {
    padding: 12px 24px;
    font-size: 14px;
    font-weight: 600;
    color: #666;
    background: transparent;
    border: none;
    border-bottom: 3px solid transparent;
    cursor: pointer;
    transition: all 0.3s;
  }

  .subtab-btn.active {
    color: #667eea;
    border-bottom-color: #667eea;
  }

  .subtab-content { display: none; }
  .subtab-content.active { display: block; }

</style>

<div class="subtabs-container">

  <div class="subtabs-nav">
    <button class="subtab-btn active" id="btn-subtab-cursos"
      onclick="switchSubTab('cursos')">ðŸ“š Cursos</button>

    <button class="subtab-btn" id="btn-subtab-repasos"
      onclick="switchSubTab('repasos')">ðŸ”„ Repasos</button>
  </div>

  <div id="subtab-cursos" class="subtab-content active" data-loaded="false">
    <?!= include('5atabcursos'); ?>
  </div>

  <div id="subtab-repasos" class="subtab-content" data-loaded="false">
    <?!= include('5atabrepasos'); ?>
  </div>

</div>

<script>
(function () {
  'use strict';

  const loaded = {
    cursos: false,
    repasos: false
  };

  function switchSubTab(name) {

    document.querySelectorAll('.subtab-content')
      .forEach(el => el.classList.remove('active'));

    document.querySelectorAll('.subtab-btn')
      .forEach(el => el.classList.remove('active'));

    document.getElementById('subtab-' + name).classList.add('active');
    document.getElementById('btn-subtab-' + name).classList.add('active');

    if (!loaded[name]) {
      loaded[name] = true;

      document.dispatchEvent(
        new CustomEvent('pbe:subtab-activated', {
          detail: name
        })
      );

      console.log('ðŸŸ¢ Subtab inicializado:', name);
    }
  }

  window.switchSubTab = switchSubTab;

  // ðŸ”¥ Auto-init SOLO del primer subtab visible
  window.addEventListener('load', () => {
    switchSubTab('cursos');
  });

  console.log('%cðŸ“¦ 4atabcursosyrep V01.20 cargado',
    'font-weight:bold;color:#667eea');
})();
</script>
